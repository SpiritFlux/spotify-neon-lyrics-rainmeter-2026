[Rainmeter]
Update=50
AccurateText=1
DynamicWindowSize=1
WindowX=60
WindowY=200
OnRefreshAction=[!CommandMeasure MeasureLyricsFetch "Run"]

[Metadata]
Name=Spotify Lyrics (WebNowPlaying Clean - Neon Purple Fixed)
Author=You
Information=Synced lyrics panel using WebNowPlaying + LRCLIB

[Variables]
PanelW=640
PanelH=420

; ==============================
; WEB NOW PLAYING
; ==============================

[MeasureTitle]
Measure=Plugin
Plugin=WebNowPlaying
PlayerType=Title

[MeasureArtist]
Measure=Plugin
Plugin=WebNowPlaying
PlayerType=Artist

[MeasurePosition]
Measure=Plugin
Plugin=WebNowPlaying
PlayerType=Position

; ==============================
; LRCLIB FETCH (CURL VERSION)
; ==============================

[MeasureLyricsFetch]
Measure=Plugin
Plugin=RunCommand
Program=curl.exe
Parameter=-s -G --data-urlencode "artist_name=[MeasureArtist]" --data-urlencode "track_name=[MeasureTitle]" https://lrclib.net/api/search
OutputType=UTF8
State=Hide
DynamicVariables=1
StartInThread=1
UpdateDivider=20
OnUpdateAction=[!CommandMeasure MeasureLyricsFetch "Run"]
FinishAction=[!UpdateMeasure MeasureLyrics][!UpdateMeterGroup Lyrics][!Redraw]

; ==============================
; LUA PARSER
; ==============================

[MeasureLyrics]
Measure=Script
ScriptFile=#@#Scripts\LyricsParser.lua
UpdateDivider=1
DynamicVariables=1

; ==============================
; PANEL
; ==============================

[MeterBackground]
Meter=Shape
Group=Lyrics
Shape=Rectangle 0,0,#PanelW#,#PanelH#,30 | Fill Color 20,10,40,150 | StrokeWidth 2 | Stroke Color 180,0,255,220
DynamicVariables=1

[MeterLyricGlow]
Meter=Shape
Group=Lyrics
X=40
Y=((#PanelH#/2)-30)
Shape=Rectangle 0,0,(#PanelW#-80),60,18 | Fill Color 180,0,255,28 | StrokeWidth 0
DynamicVariables=1

[MeterLyricPrev]
Meter=String
Group=Lyrics
Text=[&MeasureLyrics:GetLine(-1)]
X=(#PanelW#/2)
Y=((#PanelH#/2)-105)
W=(#PanelW#-80)
H=80
FontFace=Segoe UI
FontSize=22
FontColor=170,90,255,55
StringAlign=CenterCenter
AntiAlias=1
ClipString=2
DynamicVariables=1

[MeterLyricCurrentGlowText]
Meter=String
Group=Lyrics
Text=[&MeasureLyrics:GetLine(0)]
X=(#PanelW#/2)
Y=(#PanelH#/2)
W=(#PanelW#-80)
H=140
FontFace=Segoe UI Semibold
FontSize=[&MeasureLyrics:GetSizeForLine(0)]
FontColor=180,0,255,70
StringAlign=CenterCenter
AntiAlias=1
ClipString=2
DynamicVariables=1

[MeterLyricCurrent]
Meter=String
Group=Lyrics
Text=[&MeasureLyrics:GetLine(0)]
X=(#PanelW#/2)
Y=(#PanelH#/2)
W=(#PanelW#-80)
H=140
FontFace=Segoe UI Semibold
FontSize=[&MeasureLyrics:GetSizeForLine(0)]
FontColor=230,170,255,255
StringAlign=CenterCenter
AntiAlias=1
ClipString=2
DynamicVariables=1

[MeterLyricNext]
Meter=String
Group=Lyrics
Text=[&MeasureLyrics:GetLine(1)]
X=(#PanelW#/2)
Y=((#PanelH#/2)+105)
W=(#PanelW#-80)
H=80
FontFace=Segoe UI
FontSize=22
FontColor=170,90,255,55
StringAlign=CenterCenter
AntiAlias=1
ClipString=2
DynamicVariables=1